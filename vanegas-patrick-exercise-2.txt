+-------------------------------------------------------------------------------+
| Question 1                                                                    |
+-------------------------------------------------------------------------------+
| Give the first and last names of all the authors who live in California (Ca). |
+-------------------------------------------------------------------------------+
1 row in set (0.01 sec)

+----------------------------------------------------------+
| Query                                                    |
+----------------------------------------------------------+
| SELECT au_fname, au_lname FROM authors WHERE state='CA'; |
+----------------------------------------------------------+
1 row in set (0.00 sec)

+----------+------------+
| au_fname | au_lname   |
+----------+------------+
| Johnson  | White      |
| Marjorie | Green      |
| Cheryl   | Carson     |
| Michael  | O'Leary    |
| Dick     | Straight   |
| Abraham  | Bennet     |
| Ann      | Dull       |
| Burt     | Gringlesby |
| Chastity | Locksley   |
| Akiko    | Yokomoto   |
| Dirk     | Stringer   |
| Stearns  | MacFeather |
| Livia    | Karsen     |
| Sheryl   | Hunter     |
| Heather  | McBadden   |
+----------+------------+
15 rows in set (0.00 sec)

+----------------------------------------------------------------------------------------------------------------+
| Question 2                                                                                                     |
+----------------------------------------------------------------------------------------------------------------+
| List the store id, order number and title id from salesdetail where the quantity sold is between 2000 and
3000 |
+----------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+-------------------------------------------------------------------------------------+
| Query                                                                               |
+-------------------------------------------------------------------------------------+
| SELECT stor_id, ord_num, title_id FROM salesdetail WHERE qty BETWEEN 2000 and 3000; |
+-------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+---------+--------------------+----------+
| stor_id | ord_num            | title_id |
+---------+--------------------+----------+
| 5023    | AB-123-DEF-425-1Z3 | TC4203   |
| 5023    | BS-345-DSE-860-1F2 | BU2075   |
| 5023    | BS-345-DSE-860-1F2 | TC4203   |
| 5023    | GH-542-NAD-713-9F9 | PC1035   |
| 5023    | GH-542-NAD-713-9F9 | TC4203   |
| 5023    | LEMON55            | AW1234   |
| 5023    | NF-123-ADS-642-9G3 | BU2075   |
| 5023    | NF-123-ADS-642-9G3 | MC3021   |
| 5023    | XS-135-DER-432-8J2 | PC1035   |
| 5023    | XS-135-DER-432-8J2 | PS3333   |
| 5023    | ZA-000-ASD-324-4D1 | MC3021   |
| 5023    | ZA-000-ASD-324-4D1 | PC1035   |
| 5023    | ZD-123-DFG-752-9G8 | BU2075   |
| 5023    | ZS-645-CAT-415-1B2 | BU2075   |
| 5023    | ZZ-999-ZZZ-999-0A0 | MC2222   |
| 7066    | BACONBITES3        | AW1234   |
| 7067    | CKY-9              | KC2015   |
| 7067    | CKYKO-10           | KC2000   |
| 7067    | PIZZA22            | AW1234   |
| 7131    | CKYKO-5            | KC2000   |
| 7131    | CKYKO-6            | KC2000   |
| 7896    | GINGERALE          | AW1234   |
| 8042    | CKYKO-4            | KC2000   |
+---------+--------------------+----------+
23 rows in set (0.00 sec)

+-----------------------------------------------------------------------------------------------------+
| Question 3                                                                                          |
+-----------------------------------------------------------------------------------------------------+
| How many different stores appear in the salesdetail table? Identify the output with an "as" clause. |
+-----------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+-------------------------------------------------------------------+
| Query                                                             |
+-------------------------------------------------------------------+
| SELECT COUNT(DISTINCT stor_id) AS num_of_stores FROM salesdetail; |
+-------------------------------------------------------------------+
1 row in set (0.00 sec)

+---------------+
| num_of_stores |
+---------------+
|            14 |
+---------------+
1 row in set (0.01 sec)

+-------------------------------------------------------------------------+
| Question 4                                                              |
+-------------------------------------------------------------------------+
| What are the 5 oldest sales records in sales? Use order by desc, limit. |
+-------------------------------------------------------------------------+
1 row in set (0.00 sec)

+-----------------------------------------------+
| Query                                         |
+-----------------------------------------------+
| SELECT date FROM sales ORDER BY date LIMIT 5; |
+-----------------------------------------------+
1 row in set (0.00 sec)

+---------------------+
| date                |
+---------------------+
| 1985-10-12 00:00:00 |
| 1985-10-31 00:00:00 |
| 1985-11-06 00:00:00 |
| 1985-12-13 00:00:00 |
| 1986-01-02 00:00:00 |
+---------------------+
5 rows in set (0.00 sec)

+------------------------------------------------------------------------------------------------------------------+
| Question 5                                                                                                       |
+------------------------------------------------------------------------------------------------------------------+
| What book (title_id) is most ordered (qty) by bookstores in salesdetail? Identify the output with an "as"
clause |
+------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+------------------------------------------------------------------------------------+
| Query                                                                              |
+------------------------------------------------------------------------------------+
| SELECT title_id FROM salesdetail GROUP BY title_id ORDER BY SUM(qty) DESC LIMIT 1; |
+------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+----------+
| title_id |
+----------+
| AW5678   |
+----------+
1 row in set (0.00 sec)

+---------------------------------------------------------------------------------------------------------------+
| Question 6                                                                                                    |
+---------------------------------------------------------------------------------------------------------------+
| Give the total number of each title id stocked by bookstores from most to least omitting negative quantities. |
+---------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+-----------------------------------------------------------------------------------------------------------------+
| Query                                                                                                           |
+-----------------------------------------------------------------------------------------------------------------+
| SELECT title_id, SUM(qty) as total FROM store_inventories WHERE qty >= 0 GROUP BY title_id ORDER BY total DESC; |
+-----------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+----------+-------+
| title_id | total |
+----------+-------+
| AW5678   | 47139 |
| AW1234   | 43401 |
| MC3021   | 22261 |
| KC2000   | 19785 |
| BU2075   | 15761 |
| TC7777   | 15679 |
| TC4203   | 15124 |
| KC2015   | 13396 |
| PC1035   |  8875 |
| BU7832   |  4180 |
| PS3333   |  4121 |
| BU1111   |  3934 |
| PS7777   |  3395 |
| th1218   |  2500 |
| MC2222   |  2102 |
| PS2091   |  2100 |
| BU1032   |  1424 |
| PC8888   |   756 |
| RO1236   |   720 |
| FI1230   |   700 |
| GD0666   |   590 |
| SM1372   |   468 |
| PS1372   |   424 |
| SM1836   |   410 |
| TC3218   |   385 |
| AK4153   |   371 |
| AK1231   |   300 |
| PS2106   |   169 |
| FI1201   |    95 |
| FI1203   |    93 |
| PC9999   |    82 |
| FI1226   |    75 |
| FI1204   |    75 |
| FI1209   |    75 |
| TH1217   |    74 |
| TH1220   |    70 |
| TH1332   |    69 |
| FI1208   |    62 |
| FI1225   |    59 |
| TH1216   |    59 |
| FI1206   |    52 |
| FI1329   |    52 |
| RO1335   |    51 |
| FI1210   |    50 |
| FI1222   |    49 |
| TH1219   |    48 |
| FI1202   |    44 |
| MC3026   |    42 |
| BU1205   |    42 |
| RO1234   |    41 |
| FI1223   |    40 |
| FI1228   |    39 |
| RO1213   |    28 |
| FI1211   |    15 |
| RO1214   |    14 |
| FI1207   |    10 |
+----------+-------+
56 rows in set (0.00 sec)

+-------------------------------------------------------------------------------------------------------------------------------------+
| Question 7                                                                                                                          |
+-------------------------------------------------------------------------------------------------------------------------------------+
| What psychology book (actual title) is the most expensive of its type? Use max in subquery. Identify the
output with an "as" clause |
+-------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+--------------------------------------------------------------------------------------------------------------------------------------------------+
| Query                                                                                                                                            |
+--------------------------------------------------------------------------------------------------------------------------------------------------+
| SELECT title AS most_expensive_psyc_title FROM titles WHERE type='psychology' AND price=(SELECT MAX(price) FROM titles WHERE type='psychology'); |
+--------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+-----------------------------------------------------------------+
| most_expensive_psyc_title                                       |
+-----------------------------------------------------------------+
| Computer Phobic and Non-Phobic Individuals: Behavior Variations |
+-----------------------------------------------------------------+
1 row in set (0.01 sec)

+------------------------------------------------------------------------------------------------------------------------------+
| Question 8                                                                                                                   |
+------------------------------------------------------------------------------------------------------------------------------+
| List the store's name and the order number in salesdetail for all stores that bought title including Fifty
Years. Use a join |
+------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Query                                                                                                                                                                                           |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| SELECT stores.stor_name sa.ord_num FROM ((titles ti INNER JOIN salesdetail sa ON ti.title LIKE '%Fifty Years%' AND ti.title_id =sa.title_id)) INNER JOIN stores on sa.stor_id = stores.stor_id; |
+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+--------------------------------------+--------------------+
| stor_name                            | ord_num            |
+--------------------------------------+--------------------+
| Thoreau Reading Discount Chain       | AB-123-DEF-425-1Z3 |
| Thoreau Reading Discount Chain       | AX-532-FED-452-2Z7 |
| Thoreau Reading Discount Chain       | BS-345-DSE-860-1F2 |
| Thoreau Reading Discount Chain       | GH-542-NAD-713-9F9 |
| Thoreau Reading Discount Chain       | NF-123-ADS-642-9G3 |
| Eric the Read Books                  | 234518             |
| Barnum's                             | BA27618            |
| Barnum's                             | BA71224            |
| News & Brews                         | NB-1.142           |
| News & Brews                         | NB-3.142           |
| Doc-U-Mat: Quality Laundry and Books | Fsoap867           |
| Fricative Bookshop                   | 124152             |
| Fricative Bookshop                   | 234518             |
| Bookbeat                             | 12-F-9             |
| Bookbeat                             | 13-E-7             |
| Bookbeat                             | 13-J-9             |
| Contemporary                         | 2345262            |
+--------------------------------------+--------------------+
17 rows in set (0.00 sec)

+---------------------------------------------------------------------------------------------------------------------------------------------+
| Question 9                                                                                                                                  |
+---------------------------------------------------------------------------------------------------------------------------------------------+
| What book (actual title and author) is most ordered (qty) by bookstores in salesdetail? Identify the
output with an "as" clause. Use a join |
+---------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Query                                                                                                                                                                                                                                                                                                                                                                                               |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| SELECT titles.title, CONCAT(authors.au_fname, ' ', authors.au_lname) AS au_name
        FROM (SELECT title_id FROM salesdetail GROUP BY title_id ORDER BY SUM(qty) DESC LIMIT 1) AS most_ordered_title
        JOIN titles
        JOIN titleauthor
        JOIN authors
        ON titleauthor.title_id = most_ordered_title.title_id
                AND titles.title_id = most_ordered_title.title_id
                AND titleauthor.au_id = authors.au_id;
                 |
+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)

+-----------------------------+---------------+
| title                       | au_name       |
+-----------------------------+---------------+
| The Very Hungry Caterpillar | Dirk Stringer |
+-----------------------------+---------------+
1 row in set (0.01 sec)
